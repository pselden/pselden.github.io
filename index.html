<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body { margin: 0; padding: 0; background: url('http://www.budlighthotel.com/assets/content-gate/age-gate-bg-mobile-5bbabc60a53c4030739d1afe12e4275e.jpg') no-repeat; background-size: cover;}
        .ageGate { padding: 20px; text-align: center; margin-top: 175px; }
        .ageGate form { margin-top: 20px; }
        .ageGate form button { margin-top: 10px; }

    </style>
</head>
<body>
    <div class="ageGate">
        <form method="POST" action="/">
            <input type="date" name="birthDate" placeholder="mm/dd/yyyy">
            <div>
                <button type="submit" disabled>Continue</button>
            </div>
        </form>
    </div>
    <script>
        (function(){
            function getAge(birthDate) {
                var today = new Date();
                var age = today.getFullYear() - birthDate.getFullYear();
                var m = today.getMonth() - birthDate.getMonth();
                if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) {
                    age--;
                }
                return age;
            }


            function appendQs(url, key, val){
                var prefix = url.indexOf('?') === -1 ? '?' : '&';
                return url + prefix + encodeURIComponent(key) + "=" + encodeURIComponent(val);
            }

            var gate = document.querySelector('.ageGate form');
            gate.birthDate.addEventListener("change", function(e){
                gate.querySelector("[type=submit]").disabled = isNaN(new Date(e.target.value));
            });

            gate.addEventListener("submit", function(e){
                e.preventDefault();
                e.stopPropagation();
                var form = e.target;
                var birthDate = new Date(form.birthDate.value);
                var age = getAge(birthDate);
                var result = age < 21 ? 'failure' : 'success';
                window.location = appendQs(window.location.href, 'result', result);
            });
        })();
    </script>
</body>
</html>


