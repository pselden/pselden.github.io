<!DOCTYPE html>
<html>
<head>
    <style>
        body { margin: 0; padding: 0; }
        .ageGate { padding: 20px; text-align: center; }
        .ageGate form { margin-top: 20px; }
        .ageGate form button { margin-top: 10px; }

    </style>
</head>
<body>
    <div class="ageGate">
        <h1>Please enter your date of birth to continue.</h1>
        <form method="POST" action="/">
            <input type="datetime" name="birthDate" placeholder="mm/dd/yyyy">
            <div>
                <button type="submit">Continue</button>
            </div>
        </form>
    </div>
    <script>
        (function(){
            function getAge(birthDate) {
                var today = new Date();
                var age = today.getFullYear() - birthDate.getFullYear();
                var m = today.getMonth() - birthDate.getMonth();
                if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) {
                    age--;
                }
                return age;
            }

            function appendQs(url, key, val){
                var prefix = url.indexOf('?') === -1 ? '?' : '&';
                return url + prefix + encodeURIComponent(key) + "=" + encodeURIComponent(val);
            }

            var gate = document.querySelector('.ageGate form');
            gate.addEventListener("submit", function(e){
                e.preventDefault();
                e.stopPropagation();
                var form = e.target;
                var birthDate = new Date(form.birthDate.value);
                var age = getAge(birthDate);
                var result = age < 21 ? 'failure' : 'success';
                window.location = appendQs(window.location.href, 'result', result);
            });
        })();
    </script>
</body>
</html>


